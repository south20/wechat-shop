(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/classification/classification/classification"],{"0d34":function(t,e,a){"use strict";a.r(e);var r=a("dafd"),n=a.n(r);for(var o in r)"default"!==o&&function(t){a.d(e,t,(function(){return r[t]}))}(o);e["default"]=n.a},"461a":function(t,e,a){},"56a2":function(t,e,a){"use strict";(function(t){a("cd90");r(a("66fd"));var e=r(a("c040"));function r(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("543d")["createPage"])},"5dc0":function(t,e,a){"use strict";var r,n=function(){var t=this,e=t.$createElement;t._self._c},o=[];a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return r}))},c040:function(t,e,a){"use strict";a.r(e);var r=a("5dc0"),n=a("0d34");for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("db81");var i,s=a("f0c5"),c=Object(s["a"])(n["default"],r["b"],r["c"],!1,null,"33b0d712",null,!1,r["a"],i);e["default"]=c.exports},dafd:function(t,e,a){"use strict";(function(t){function r(t){return s(t)||i(t)||o(t)||n()}function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,e){if(t){if("string"===typeof t)return c(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?c(t,e):void 0}}function i(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function s(t){if(Array.isArray(t))return c(t)}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;getApp();var d=function(){a.e("pages/classification/shopcart/shopcart").then(function(){return resolve(a("7e97"))}.bind(null,a)).catch(a.oe)},p=function(){a.e("pages/footer/footer").then(function(){return resolve(a("2175"))}.bind(null,a)).catch(a.oe)},u=function(){a.e("pages/utill/addShopCartLayer/addShopCartLayer").then(function(){return resolve(a("13f2"))}.bind(null,a)).catch(a.oe)},h={data:function(){return{active:0,current:0,shopAdminCategory:[],shopCategory:[],data:[],foorterFlag:!1,background:"",layerFlag:!1,propertyList:[],cartGood:{},cartProperty:{},propertyindex:0,cartindex:0,ajaxFlag:!0,loginFlag:!1,page:1,m_category_id:0,supplier_id:0,cartUpdata:0,property1index:0,property2index:0,number:1,layerData:"",property1List:"",property1_name:"",property2_name:"",property2List:"",goodPropertyDetail:"",cartShowLayer:!1}},components:{ShopCart:d,diyfooter:p,shopCartLayer:u},props:{},onLoad:function(e){var a=this;this.options=e,this.setTheme(),wx.setNavigationBarTitle({title:"商品分类"}),this.getOneList(),this.setData({background:t.getStorageSync("background")||"red"}),this.login().then((function(t){a.setData({loginFlag:!0})})),e.hasOwnProperty("user_id")&&wx.setStorageSync("shareInfo",{sharePeople_id:e.user_id,leader_id:e.leader_id})},onShow:function(){},onReachBottom:function(){this.getData()},onShareAppMessage:function(){return{title:t.getStorageSync("shopInfo").name,path:"/pages/classification/classification/classification?user_id=".concat(t.getStorageSync("user").id,"&leader_id=").concat(t.getStorageSync("area_id"))}},methods:{tab1:function(t){this.setData({active:t.currentTarget.dataset.index,current:0}),this.getTwoList(t.currentTarget.dataset.id)},tab2:function(t){this.setData({current:t.currentTarget.dataset.index,m_category_id:t.currentTarget.dataset.id,page:1,data:[]}),this.getData()},getOneList:function(){var e=this;this.http({url:"shopAdminCategory",data:{key:t.getStorageSync("shopkey"),supplier_id:0}}).then((function(t){e.setData({shopAdminCategory:t.data.data}),e.getTwoList(t.data.data[0].id)}))},getTwoList:function(e){var a=this;this.http({url:"shopCategory/".concat(e),data:{key:t.getStorageSync("shopkey")}}).then((function(t){a.setData({shopCategory:t.data,m_category_id:t.data[0].id,page:1,data:[]}),a.getData()})).catch((function(t){a.setData({shopCategory:[],page:1,m_category_id:0,data:[]})}))},getData:function(e){var a=this,n=this.data;this.http({url:"shopGoods",data:{key:t.getStorageSync("shopkey"),m_category_id:this.m_category_id,current_page:this.page}}).then((function(t){a.setData({data:[].concat(r(n),r(t.data)),page:a.page+1})})).catch((function(t){a.setData({data:[].concat(r(n),r(t.data))})}))},toItem:function(t){console.log(t.currentTarget.dataset),t.currentTarget.dataset.is_bargain?wx.navigateTo({url:"/bargaining/pages/goodItem/goodItem/goodItem?id=".concat(t.currentTarget.dataset.id)}):wx.navigateTo({url:"/pages/goodsItem/goodsItem/goodsItem?id=".concat(t.currentTarget.dataset.id,"&name=").concat(t.currentTarget.dataset.name)})},go:function(t){wx.redirectTo({url:t.currentTarget.dataset.url})},show:function(t){console.log(t),this.setData({foorterFlag:t.detail.flag})},initcartData:function(t){this.setData({cartGood:t.detail.cartGood,cartProperty:t.detail.cartProperty})},addShopCart:function(t,e){var a,r=this;a="property"==t.type?{id:t.id,stock_id:t.stock_id,supplier_id:t.supplier_id}:this.data[t.currentTarget?t.currentTarget.dataset.index:t.index],a={goods_id:a.id,stock_id:a.stock_id||a.stock[0].id,number:"reduce"==e?-1:1,supplier_id:a.supplier_id},"property"==t.type&&(a.number=this.number),!0===this.httpFlag&&(this.setData({ajaxFlag:!1}),console.log(this.httpFlag),this.http({url:"shopCart",method:"post",data:a}).then((function(t){wx.showToast({title:"添加成功",icon:"none"}),r.setData({cartindex:r.cartindex+1,ajaxFlag:!0,layerFlag:!r.layerFlag,propertyindex:0})})).catch((function(t){r.setData({ajaxFlag:!0})})))},showProperty:function(t){var e=this.data[t.currentTarget.dataset.index];t.currentTarget.dataset.index,console.log(e),this.setData({propertyList:Object.fromEntries(e.stock.map((function(t){return[t.property1_name+t.property2_name,t.id]}))),supplier_id:this.data[t.currentTarget.dataset.index].supplier_id,layerData:e,cartShowLayer:!this.cartShowLayer})},showLayer:function(){this.setData({layerFlag:!this.layerFlag,propertyindex:0})},propertyToCart:function(t){var e={type:"property",id:this.goodPropertyDetail.goods_id,stock_id:this.goodPropertyDetail.id,supplier_id:this.supplier_id};this.addShopCart(e,"reduce"==t.currentTarget.dataset.type?"reduce":"add")},operationShopCart:function(t){this.addShopCart({index:t.currentTarget.dataset.index},"reduce")},spliceProperty1:function(){var e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{currentTarget:{dataset:{index:0}}},r=this.layerData.property1.split(":")[1].split(","),n=this.layerData.property1.split(":")[0],o=this.layerData.property2.split(":")[0];this.http({url:"shopGoodsStockProperty/".concat(this.layerData.id),data:{property1_name:r[a.currentTarget.dataset.index],key:t.getStorageSync("shopkey")}}).then((function(t){e.setData({property1List:r,property1_name:n,property2_name:o,property2List:t.data.map((function(t){return t.property2_name})),property1index:a.currentTarget.dataset.index}),e.getPropertyDetail()}))},getPropertyDetail:function(){var e=this,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{currentTarget:{dataset:{index:0}}};this.http({url:"shopGoodsStock/".concat(this.layerData.id),data:{property1_name:this.property1List[this.property1index],property2_name:this.property2List[a.currentTarget.dataset.index],key:t.getStorageSync("shopkey")}}).then((function(t){e.setData({goodPropertyDetail:t.data,property2index:a.currentTarget.dataset.index})}))},changeNumber:function(t){var e=this.number;if("add"===t.currentTarget.dataset.type){if(this.goodPropertyDetail.number==e)return!1;e+=1}else{if(1==this.number)return!1;e-=1}this.setData({number:e})},cartUpdataFun:function(){this.setData({cartindex:this.cartindex+1})},cartChangeshowLayer:function(){this.cartShowLayer=!this.cartShowLayer}}};e.default=h}).call(this,a("543d")["default"])},db81:function(t,e,a){"use strict";var r=a("461a"),n=a.n(r);n.a}},[["56a2","common/runtime","common/vendor"]]]);