(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/shopCart/shopCart/shopCart"],{5537:function(t,e,n){"use strict";n.r(e);var a=n("cb7c"),r=n("a4c8");for(var o in r)"default"!==o&&function(t){n.d(e,t,(function(){return r[t]}))}(o);n("e35e");var i,c=n("f0c5"),u=Object(c["a"])(r["default"],a["b"],a["c"],!1,null,"59e827fa",null,!1,a["a"],i);e["default"]=u.exports},"59d3":function(t,e,n){},a329:function(t,e,n){"use strict";(function(t){function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function i(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=c(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,r,o=!0,i=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return o=t.done,t},e:function(t){i=!0,r=t},f:function(){try{o||null==a.return||a.return()}finally{if(i)throw r}}}}function c(t,e){if(t){if("string"===typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;getApp();var s=function(){n.e("pages/shopCart/header/header").then(function(){return resolve(n("e284"))}.bind(null,n)).catch(n.oe)},l=function(){n.e("pages/shopCart/cartData/cartData").then(function(){return resolve(n("7a29"))}.bind(null,n)).catch(n.oe)},f=function(){n.e("pages/shopCart/shopItem/shopItem").then(function(){return resolve(n("a777"))}.bind(null,n)).catch(n.oe)},d=function(){n.e("pages/shopCart/footer/footer").then(function(){return resolve(n("b170"))}.bind(null,n)).catch(n.oe)},h=function(){n.e("pages/shopCart/nodata/nodata").then(function(){return resolve(n("b794"))}.bind(null,n)).catch(n.oe)},p=function(){n.e("pages/footer/footer").then(function(){return resolve(n("2175"))}.bind(null,n)).catch(n.oe)},g=function(){n.e("pages/utill/noLogin/noLogin").then(function(){return resolve(n("c0c6"))}.bind(null,n)).catch(n.oe)},b={data:function(){return{show:!0,cartData:[],allPrice:"",flag:!1,chooseData:[],noLogin:!1,page:!1,nodataFlag:!0,background:"red",cartUpdata:0}},components:{cartHeader:s,cartData:l,shopItem:f,Cartfooter:d,nodata:h,diyfooter:p,login:g},props:{},onShow:function(){this.setData({flag:!1,background:t.getStorageSync("background")}),this.setTheme(),this.getCartList(),wx.setNavigationBarTitle({title:"购物车"}),wx.setStorageSync("leader_discount",0),wx.setStorageSync("tuanNum",0)},methods:{checkALl:function(t){var e=this;this.setAllGoodsIsBind(t.detail.flag).then((function(n){e.setData({flag:t.detail.flag,cartData:n.data,allPrice:Math.round(100*n.price)/100,chooseData:t.detail.flag?n.data.filter((function(t){return t.goods_status})):[]})}))},changeCartData:function(t){var e=this.cartData;e[t.detail.shopindex].list[t.detail.cartData_index].flag=t.detail.flag,console.log(t.detail);var n=this.selectGoodsIsBind(e);this.setData({allPrice:Math.round(100*n.price)/100,cartData:e,flag:!e.map((function(t){return t.list.map((function(t){return t.flag}))})).flat().includes(!1),chooseData:n.chooseData})},changeGoodsNumber:function(t){var e=[],n=this.cartData;try{n[t.detail.shopindex].list[t.detail.cartData_index].number=t.detail.number}catch(a){}e=this.selectGoodsIsBind(n),this.setData({allPrice:Math.round(100*e.price)/100,cartData:n,chooseData:e.chooseData})},showDel:function(t){this.setData({show:t.detail.flag})},getCartList:function(){var t=this;this.http({url:"shopCarts"}).then((function(e){var n={};0!=t.cartData.length&&(n=Object.fromEntries(t.cartData.map((function(t){return t.list.flat(2)})).flat(3).map((function(t){return[t.stock_id,t.flag]}))));var a,o=[],c=i(e.data.flat(2));try{var u=function(){var t=a.value,e=o.find((function(e){return e.supplier_id==t.supplier_id&&e.goods_status==t.goods_status==1}));e?e.list.push(t):o.push({supplier_id:t.supplier_id,supplier_name:t.supplier_name,list:[r({},t,{flag:n[t.stock_id]||!1})],goods_status:1==t.goods_status})};for(c.s();!(a=c.n()).done;)u()}catch(s){c.e(s)}finally{c.f()}t.setData({cartData:o,nodataFlag:!1,chooseData:[],cartUpdata:t.cartUpdata+1}),t.changeGoodsNumber()})).catch((function(e){204===e.status&&(t.setData({cartData:[],chooseData:[],nodataFlag:!0,allPrice:0,cartUpdata:t.cartUpdata+1}),t.changeGoodsNumber())}))},showFun:function(){this.setData({page:!0})},setAllGoodsIsBind:function(t){var e=this;return new Promise((function(n,a){var o=0;console.log(e.cartData);var i=e.cartData.map((function(e){return r({},e,{list:e.list.map((function(e){return t&&(o+=Number(1==e.goods_status?e.price:0)*e.number),r({},e,{flag:1==e.goods_status&&t})}))})}));n({price:t?o:0,data:i})}))},selectGoodsIsBind:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=[],n=0;if(0!=t.length){e=t.filter((function(t){return t.goods_status})).map((function(t){return r({},t,{list:t.list.filter((function(t){return t.flag}))})})).filter((function(t){return 0!=t.list.length}));try{n=t.map((function(t){return t.list.filter((function(t){return t.flag})).map((function(t){return t.price*t.number}))})).flat().reduce((function(t,e,n){return Number(t)+Number(e)}))}catch(a){}}return{price:n,chooseData:e}}}};e.default=b}).call(this,n("543d")["default"])},a4c8:function(t,e,n){"use strict";n.r(e);var a=n("a329"),r=n.n(a);for(var o in a)"default"!==o&&function(t){n.d(e,t,(function(){return a[t]}))}(o);e["default"]=r.a},cb7c:function(t,e,n){"use strict";var a,r=function(){var t=this,e=t.$createElement;t._self._c},o=[];n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"a",(function(){return a}))},e35e:function(t,e,n){"use strict";var a=n("59d3"),r=n.n(a);r.a},fd92:function(t,e,n){"use strict";(function(t){n("cd90");a(n("66fd"));var e=a(n("5537"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])}},[["fd92","common/runtime","common/vendor"]]]);